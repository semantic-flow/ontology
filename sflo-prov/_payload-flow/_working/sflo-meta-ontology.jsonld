{
  "@context": {
    "@base": "https://semantic-flow.github.io/ontology/sflo-meta/",
    "owl": "http://www.w3.org/2002/07/owl#",
    "rdf": "http://www.w3.org/1999/02/22-rdf-syntax-ns#",
    "rdfs": "http://www.w3.org/2000/01/rdf-schema#",
    "xsd": "http://www.w3.org/2001/XMLSchema#",
    "sh": "http://www.w3.org/ns/shacl#",
    "dcterms": "http://purl.org/dc/terms/",
    "dcat": "http://www.w3.org/ns/dcat#",
    "prov": "http://www.w3.org/ns/prov#",
    "schema": "https://schema.org/"
  },
  "@graph": [
    {
      "@id": "",
      "@type": "owl:Ontology",
      "dcterms:title": "Semantic Flow Metadata Ontology",
      "dcterms:description": "Comprehensive provenance and metadata schema for knops, their flow datasets, and weaving operations. Defines properties for tracking dataset series information, provenance contexts, delegation chains, agent roles, and weave activities. Captures complex authorship scenarios and collaborative activities within the Semantic Flow mesh ecosystem. The recommended prefix is 'meta' (alternatives: 'metaflow', 'meta-flow', 'mf').",
      "dcterms:creator": "Semantic Flow Project",
      "owl:versionInfo": "0.2.0",
      "mesh:preferredNamespacePrefix": "meta",
      "mesh:alternateNamespacePrefix": [
        "sflo-meta"
      ]
    },
    {
      "@id": "ProvenanceClass/",
      "@type": "rdfs:Class",
      "rdfs:label": "Provenance Class",
      "rdfs:comment": "Classes that structure provenance information within meta-flow distributions.",
      "rdfs:subClassOf": {
        "@id": "MetadataClass/"
      }
    },
    {
      "@id": "ProvenanceTemplate/",
      "@type": "rdfs:Class",
      "rdfs:label": "Provenance Template",
      "rdfs:comment": "Template for constructing ProvenanceContext instances at weave/meta time. May pre-bind role types, agent placeholders, or activity classes, but does not itself require a specific version or activity.",
      "rdfs:subClassOf": {
        "@id": "ProvenanceClass/"
      }
    },
    {
      "@id": "ProvenanceContext/",
      "@type": "rdfs:Class",
      "rdfs:label": "Provenance Context",
      "rdfs:comment": "A relator that captures complex authorship scenarios for mesh operations, binding together activities, agents, delegation chains, and agent roles. Uses prov:wasAttributedTo to identify the primary responsible agent.",
      "rdfs:subClassOf": {
        "@id": "ProvenanceClass/"
      }
    },
    {
      "@id": "DelegationChain/",
      "@type": "rdfs:Class",
      "rdfs:label": "Delegation Chain",
      "rdfs:comment": "A collection of delegation steps that form an authorization chain.",
      "rdfs:subClassOf": {
        "@id": "ProvenanceClass/"
      }
    },
    {
      "@id": "DelegationStep/",
      "@type": "rdfs:Class",
      "rdfs:label": "Delegation Step",
      "rdfs:comment": "An individual step in an authorization chain, showing one agent acting on behalf of another using prov:agent and prov:actedOnBehalfOf.",
      "rdfs:subClassOf": {
        "@id": "ProvenanceClass/"
      }
    },
    {
      "@id": "AgentRoleCollection/",
      "@type": "rdfs:Class",
      "rdfs:label": "Agent Role Collection",
      "rdfs:comment": "A collection of agent role relators for collaborative activities.",
      "rdfs:subClassOf": {
        "@id": "ProvenanceClass/"
      }
    },
    {
      "@id": "AgentRoleRelator/",
      "@type": "rdfs:Class",
      "rdfs:label": "Agent Role",
      "rdfs:comment": "Describes the specific role an agent plays in a collaborative activity, using prov:agent to identify the agent.",
      "rdfs:subClassOf": {
        "@id": "ProvenanceClass/"
      }
    },
    {
      "@id": "RoleType/",
      "@type": "rdfs:Class",
      "rdfs:label": "Role Type",
      "rdfs:comment": "Types of roles agents can play in activities."
    },
    {
      "@id": "MeshActivity/",
      "@type": "rdfs:Class",
      "rdfs:label": "Mesh Activity",
      "rdfs:comment": "Base class for all Semantic Flow mesh operations including weaving, grafting, and initialization activities.",
      "rdfs:subClassOf": {
        "@id": "prov:Activity"
      }
    },
    {
      "@id": "WeaveActivity/",
      "@type": "rdfs:Class",
      "rdfs:label": "Weave Activity",
      "rdfs:comment": "Base class for all Semantic Flow mesh weaving operations.",
      "rdfs:subClassOf": {
        "@id": "MeshActivity/"
      }
    },
    {
      "@id": "KnopCreation/",
      "@type": "rdfs:Class",
      "rdfs:label": "Knop Creation",
      "rdfs:comment": "Activity for creating new knops on the filesystem.",
      "rdfs:subClassOf": {
        "@id": "MeshActivity/"
      }
    },
    {
      "@id": "KnopWeave/",
      "@type": "rdfs:Class",
      "rdfs:label": "Knop Weave",
      "rdfs:comment": "Weaving operation that updates all flows within a knop.",
      "rdfs:subClassOf": {
        "@id": "WeaveActivity/"
      }
    },
    {
      "@id": "MeshWeave/",
      "@type": "rdfs:Class",
      "rdfs:label": "Knop Tree Weave",
      "rdfs:comment": "Weaving operation that recursively updates knops and their contained knops.",
      "rdfs:subClassOf": {
        "@id": "WeaveActivity/"
      }
    },
    {
      "@id": "dataExtraction/",
      "@type": "RoleType/",
      "rdfs:label": "data extraction",
      "rdfs:comment": "Responsible for extracting or gathering data."
    },
    {
      "@id": "qualityAssurance/",
      "@type": "RoleType/",
      "rdfs:label": "quality assurance",
      "rdfs:comment": "Responsible for validating and ensuring quality."
    },
    {
      "@id": "finalApproval/",
      "@type": "RoleType/",
      "rdfs:label": "final approval",
      "rdfs:comment": "Responsible for final review and approval."
    },
    {
      "@id": "coordination/",
      "@type": "RoleType/",
      "rdfs:label": "coordination",
      "rdfs:comment": "Responsible for coordinating between other agents."
    },
    {
      "@id": "forActivity/",
      "@type": "owl:ObjectProperty",
      "rdfs:label": "for activity",
      "rdfs:comment": "Links a provenance context to the activity it describes.",
      "schema:domainIncludes": {
        "@id": "ProvenanceContext/"
      },
      "schema:rangeIncludes": {
        "@id": "prov:Activity"
      }
    },
    {
      "@id": "forVersion/",
      "@type": "owl:ObjectProperty",
      "rdfs:label": "for version",
      "rdfs:comment": "Links a provenance context to the specific version it describes.",
      "schema:domainIncludes": {
        "@id": "ProvenanceContext/"
      },
      "schema:rangeIncludes": {
        "@id": "FlowSlice/"
      }
    },
    {
      "@id": "delegationChain/",
      "@type": "owl:ObjectProperty",
      "rdfs:label": "delegation chain",
      "rdfs:comment": "Links to a collection of delegation steps showing the authorization chain.",
      "schema:domainIncludes": {
        "@id": "ProvenanceContext/"
      },
      "schema:rangeIncludes": {
        "@id": "DelegationChain/"
      }
    },
    {
      "@id": "agentRoles/",
      "@type": "owl:ObjectProperty",
      "rdfs:label": "agent roles",
      "rdfs:comment": "Links to a collection of agent role assignments.",
      "schema:domainIncludes": {
        "@id": "ProvenanceContext/"
      },
      "schema:rangeIncludes": {
        "@id": "AgentRoleCollection/"
      }
    },
    {
      "@id": "hasStep/",
      "@type": "owl:ObjectProperty",
      "rdfs:label": "has step",
      "rdfs:comment": "Links a delegation chain to its individual steps.",
      "schema:domainIncludes": {
        "@id": "DelegationChain/"
      },
      "schema:rangeIncludes": {
        "@id": "DelegationStep/"
      }
    },
    {
      "@id": "stepOrder/",
      "@type": "owl:DatatypeProperty",
      "rdfs:label": "step order",
      "rdfs:comment": "The order of this step in the delegation chain (1, 2, 3, etc.).",
      "schema:domainIncludes": {
        "@id": "DelegationStep/"
      },
      "schema:rangeIncludes": {
        "@id": "xsd:integer"
      }
    },
    {
      "@id": "hasRole/",
      "@type": "owl:ObjectProperty",
      "rdfs:label": "has role",
      "rdfs:comment": "Links an agent role collection to individual role assignments.",
      "schema:domainIncludes": {
        "@id": "AgentRoleCollection/"
      },
      "schema:rangeIncludes": {
        "@id": "AgentRole/"
      }
    },
    {
      "@id": "role/",
      "@type": "owl:ObjectProperty",
      "rdfs:label": "role",
      "rdfs:comment": "The specific role or function the agent performs.",
      "schema:domainIncludes": {
        "@id": "AgentRole/"
      },
      "schema:rangeIncludes": {
        "@id": "RoleType/"
      }
    },
    {
      "@id": "wasTriggeredBy/",
      "@type": "owl:ObjectProperty",
      "rdfs:label": "was triggered by",
      "rdfs:comment": "Links an automatic activity (like MetaWeave) to the activity that triggered it.",
      "schema:domainIncludes": {
        "@id": "prov:Activity"
      },
      "schema:rangeIncludes": {
        "@id": "prov:Activity"
      }
    },
    {
      "@id": "ProvenanceContextShape/",
      "@type": "sh:KnopShape",
      "sh:targetClass": {
        "@id": "ProvenanceContext/"
      },
      "sh:property": [
        {
          "@type": "sh:PropertyShape",
          "sh:path": {
            "@id": "forActivity/"
          },
          "sh:class": {
            "@id": "prov:Activity"
          },
          "sh:minCount": 1,
          "sh:maxCount": 1,
          "sh:message": "Provenance context must reference exactly one activity"
        },
        {
          "@type": "sh:PropertyShape",
          "sh:path": {
            "@id": "forVersion/"
          },
          "sh:class": {
            "@id": "flow:Version/"
          },
          "sh:minCount": 1,
          "sh:maxCount": 1,
          "sh:message": "Provenance context must reference exactly one version"
        },
        {
          "@type": "sh:PropertyShape",
          "sh:path": {
            "@id": "prov:wasAttributedTo"
          },
          "sh:class": {
            "@id": "prov:Agent"
          },
          "sh:minCount": 1,
          "sh:maxCount": 1,
          "sh:message": "Provenance context must have exactly one primary agent"
        }
      ]
    },
    {
      "@id": "DelegationStepShape/",
      "@type": "sh:KnopShape",
      "sh:targetClass": {
        "@id": "DelegationStep/"
      },
      "sh:property": [
        {
          "@type": "sh:PropertyShape",
          "sh:path": {
            "@id": "prov:agent"
          },
          "sh:class": {
            "@id": "prov:Agent"
          },
          "sh:minCount": 1,
          "sh:maxCount": 1,
          "sh:message": "Delegation step must have exactly one agent"
        },
        {
          "@type": "sh:PropertyShape",
          "sh:path": {
            "@id": "stepOrder/"
          },
          "sh:datatype": {
            "@id": "xsd:integer"
          },
          "sh:minInclusive": 1,
          "sh:message": "Step order must be a positive integer"
        }
      ]
    },
    {
      "@id": "AgentRoleShape/",
      "@type": "sh:KnopShape",
      "sh:targetClass": {
        "@id": "AgentRole/"
      },
      "sh:property": [
        {
          "@type": "sh:PropertyShape",
          "sh:path": {
            "@id": "prov:agent"
          },
          "sh:class": {
            "@id": "prov:Agent"
          },
          "sh:minCount": 1,
          "sh:maxCount": 1,
          "sh:message": "Agent role must have exactly one agent"
        },
        {
          "@type": "sh:PropertyShape",
          "sh:path": {
            "@id": "role/"
          },
          "sh:class": {
            "@id": "RoleType/"
          },
          "sh:minCount": 1,
          "sh:maxCount": 1,
          "sh:message": "Agent role must specify exactly one role type"
        },
        {
          "@id": "DelegationStepConditionalShape/",
          "@type": "sh:KnopShape",
          "sh:targetClass": {
            "@id": "DelegationStep/"
          },
          "sh:or": [
            {
              "@type": "sh:KnopShape",
              "sh:property": [
                {
                  "@type": "sh:PropertyShape",
                  "sh:path": {
                    "@id": "stepOrder/"
                  },
                  "sh:hasValue": 1
                }
              ]
            },
            {
              "@type": "sh:KnopShape",
              "sh:property": [
                {
                  "@type": "sh:PropertyShape",
                  "sh:path": {
                    "@id": "stepOrder/"
                  },
                  "sh:minExclusive": 1
                },
                {
                  "@type": "sh:PropertyShape",
                  "sh:path": {
                    "@id": "prov:actedOnBehalfOf"
                  },
                  "sh:class": {
                    "@id": "prov:Agent"
                  },
                  "sh:minCount": 1,
                  "sh:maxCount": 1,
                  "sh:message": "Delegation steps after step 1 must specify exactly one entity the agent acts for"
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}
