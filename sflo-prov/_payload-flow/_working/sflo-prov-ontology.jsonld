{
  "@context": {
    "@base": "https://semantic-flow.github.io/ontology/sflo-prov/",
    "owl": "http://www.w3.org/2002/07/owl#",
    "rdf": "http://www.w3.org/1999/02/22-rdf-syntax-ns#",
    "rdfs": "http://www.w3.org/2000/01/rdf-schema#",
    "xsd": "http://www.w3.org/2001/XMLSchema#",
    "sh": "http://www.w3.org/ns/shacl#",
    "dcterms": "http://purl.org/dc/terms/",
    "dcat": "http://www.w3.org/ns/dcat#",
    "prov": "http://www.w3.org/ns/prov#",
    "schema": "https://schema.org/",
    "sflo-prov": "https://semantic-flow.github.io/ontology/sflo-prov/",
    "mesh": "https://semantic-flow.github.io/ontology/mesh/",
    "node": "https://semantic-flow.github.io/ontology/node/",
    "flow": "https://semantic-flow.github.io/ontology/flow/"
  },
  "@graph": [
    {
      "@id": "meta:",
      "@type": "owl:Ontology",
      "dcterms:title": "Semantic Flow Metadata-Flow Ontology",
      "dcterms:description": "Comprehensive provenance and metadata schema for nodes, their flow datasets, and weaving operations. Defines properties for tracking dataset series information, provenance contexts, delegation chains, agent roles, and weave activities. Captures complex authorship scenarios and collaborative activities within the Semantic Flow mesh ecosystem. The recommended prefix is 'meta' (alternatives: 'metaflow', 'meta-flow', 'mf').",
      "dcterms:creator": "Semantic Flow Project",
      "owl:versionInfo": "0.2.0",
      "mesh:preferredNamespacePrefix": "meta",
      "mesh:alternateNamespacePrefix": ["metaflow", "meta-flow", "mf"]
    },
    {
      "@id": "MetadataClass/",
      "@type": "rdfs:Class",
      "rdfs:label": "Metadata Class",
      "rdfs:comment": "Classes that structure metadata information within meta-flow distributions."
    },
    {
      "@id": "ProvenanceClass/",
      "@type": "rdfs:Class",
      "rdfs:label": "Provenance Class",
      "rdfs:comment": "Classes that structure provenance information within meta-flow distributions.",
      "rdfs:subClassOf": { "@id": "MetadataClass/" }
    },
    {
      "@id": "ProvenanceContext/",
      "@type": "rdfs:Class",
      "rdfs:label": "Provenance Context",
      "rdfs:comment": "A relator that captures complex authorship scenarios for mesh operations, binding together activities, agents, delegation chains, and agent roles. Uses prov:wasAttributedTo to identify the primary responsible agent.",
      "rdfs:subClassOf": { "@id": "ProvenanceClass/" }
    },
    {
      "@id": "DelegationChain/",
      "@type": "rdfs:Class",
      "rdfs:label": "Delegation Chain",
      "rdfs:comment": "A collection of delegation steps that form an authorization chain.",
      "rdfs:subClassOf": { "@id": "ProvenanceClass/" }
    },
    {
      "@id": "DelegationStep/",
      "@type": "rdfs:Class",
      "rdfs:label": "Delegation Step",
      "rdfs:comment": "An individual step in an authorization chain, showing one agent acting on behalf of another using prov:agent and prov:actedOnBehalfOf.",
      "rdfs:subClassOf": { "@id": "ProvenanceClass/" }
    },
    {
      "@id": "AgentRoleCollection/",
      "@type": "rdfs:Class",
      "rdfs:label": "Agent Role Collection",
      "rdfs:comment": "A collection of agent role assignments for collaborative activities.",
      "rdfs:subClassOf": { "@id": "ProvenanceClass/" }
    },
    {
      "@id": "AgentRole/",
      "@type": "rdfs:Class",
      "rdfs:label": "Agent Role",
      "rdfs:comment": "Describes the specific role an agent plays in a collaborative activity, using prov:agent to identify the agent.",
      "rdfs:subClassOf": { "@id": "ProvenanceClass/" }
    },
    {
      "@id": "RoleType/",
      "@type": "rdfs:Class",
      "rdfs:label": "Role Type",
      "rdfs:comment": "Types of roles agents can play in activities."
    },
    {
      "@id": "MeshActivity/",
      "@type": "rdfs:Class",
      "rdfs:label": "Mesh Activity",
      "rdfs:comment": "Base class for all Semantic Flow mesh operations including weaving, grafting, and initialization activities.",
      "rdfs:subClassOf": { "@id": "prov:Activity" }
    },
    {
      "@id": "WeaveActivity/",
      "@type": "rdfs:Class",
      "rdfs:label": "Weave Activity",
      "rdfs:comment": "Base class for all Semantic Flow mesh weaving operations.",
      "rdfs:subClassOf": { "@id": "MeshActivity/" }
    },
    {
      "@id": "NodeCreation/",
      "@type": "rdfs:Class",
      "rdfs:label": "Node Creation",
      "rdfs:comment": "Activity for creating new nodes on the filesystem.",
      "rdfs:subClassOf": { "@id": "MeshActivity/" }
    },
    {
      "@id": "ConfigWeave/",
      "@type": "rdfs:Class",
      "rdfs:label": "Config Weave",
      "rdfs:comment": "Weaving operation that updates configuration flows.",
      "rdfs:subClassOf": { "@id": "WeaveActivity/" }
    },
    {
      "@id": "ReferenceWeave/",
      "@type": "rdfs:Class",
      "rdfs:label": "Reference Weave",
      "rdfs:comment": "Weaving operation that updates reference flows.",
      "rdfs:subClassOf": { "@id": "WeaveActivity/" }
    },
    {
      "@id": "PayloadWeave/",
      "@type": "rdfs:Class",
      "rdfs:label": "Payload Weave",
      "rdfs:comment": "Weaving operation that updates payload data flows.",
      "rdfs:subClassOf": { "@id": "WeaveActivity/" }
    },
    {
      "@id": "MetaWeave/",
      "@type": "rdfs:Class",
      "rdfs:label": "Meta Weave",
      "rdfs:comment": "Weaving operation that updates meta-flows (automatically triggered).",
      "rdfs:subClassOf": { "@id": "WeaveActivity/" }
    },
    {
      "@id": "NodeWeave/",
      "@type": "rdfs:Class",
      "rdfs:label": "Node Weave",
      "rdfs:comment": "Weaving operation that updates all flows within a node.",
      "rdfs:subClassOf": { "@id": "WeaveActivity/" }
    },
    {
      "@id": "NodeTreeWeave/",
      "@type": "rdfs:Class",
      "rdfs:label": "Node Tree Weave",
      "rdfs:comment": "Weaving operation that recursively updates nodes and their contained nodes.",
      "rdfs:subClassOf": { "@id": "WeaveActivity/" }
    },
    {
      "@id": "dataExtraction/",
      "@type": "RoleType/",
      "rdfs:label": "data extraction",
      "rdfs:comment": "Responsible for extracting or gathering data."
    },
    {
      "@id": "qualityAssurance/",
      "@type": "RoleType/",
      "rdfs:label": "quality assurance",
      "rdfs:comment": "Responsible for validating and ensuring quality."
    },
    {
      "@id": "finalApproval/",
      "@type": "RoleType/",
      "rdfs:label": "final approval",
      "rdfs:comment": "Responsible for final review and approval."
    },
    {
      "@id": "coordination/",
      "@type": "RoleType/",
      "rdfs:label": "coordination",
      "rdfs:comment": "Responsible for coordinating between other agents."
    },
    {
      "@id": "versioningState/",
      "@type": "owl:DatatypeProperty",
      "rdfs:label": "versioning state",
      "rdfs:comment": "The versioning state of a flow: 'versioned', 'unversioned', or 'deversioned'.",
      "schema:domainIncludes": { "@id": "node:Flow/" },
      "schema:rangeIncludes": { "@id": "xsd:string" }
    },
    {
      "@id": "forActivity/",
      "@type": "owl:ObjectProperty",
      "rdfs:label": "for activity",
      "rdfs:comment": "Links a provenance context to the activity it describes.",
      "schema:domainIncludes": { "@id": "ProvenanceContext/" },
      "schema:rangeIncludes": { "@id": "prov:Activity" }
    },
    {
      "@id": "forSnapshot/",
      "@type": "owl:ObjectProperty",
      "rdfs:label": "for snapshot",
      "rdfs:comment": "Links a provenance context to the specific snapshot it describes.",
      "schema:domainIncludes": { "@id": "ProvenanceContext/" },
      "schema:rangeIncludes": { "@id": "flow:Snapshot/" }
    },
    {
      "@id": "delegationChain/",
      "@type": "owl:ObjectProperty",
      "rdfs:label": "delegation chain",
      "rdfs:comment": "Links to a collection of delegation steps showing the authorization chain.",
      "schema:domainIncludes": { "@id": "ProvenanceContext/" },
      "schema:rangeIncludes": { "@id": "DelegationChain/" }
    },
    {
      "@id": "agentRoles/",
      "@type": "owl:ObjectProperty",
      "rdfs:label": "agent roles",
      "rdfs:comment": "Links to a collection of agent role assignments.",
      "schema:domainIncludes": { "@id": "ProvenanceContext/" },
      "schema:rangeIncludes": { "@id": "AgentRoleCollection/" }
    },
    {
      "@id": "hasStep/",
      "@type": "owl:ObjectProperty",
      "rdfs:label": "has step",
      "rdfs:comment": "Links a delegation chain to its individual steps.",
      "schema:domainIncludes": { "@id": "DelegationChain/" },
      "schema:rangeIncludes": { "@id": "DelegationStep/" }
    },
    {
      "@id": "stepOrder/",
      "@type": "owl:DatatypeProperty",
      "rdfs:label": "step order",
      "rdfs:comment": "The order of this step in the delegation chain (1, 2, 3, etc.).",
      "schema:domainIncludes": { "@id": "DelegationStep/" },
      "schema:rangeIncludes": { "@id": "xsd:integer" }
    },
    {
      "@id": "hasRole/",
      "@type": "owl:ObjectProperty",
      "rdfs:label": "has role",
      "rdfs:comment": "Links an agent role collection to individual role assignments.",
      "schema:domainIncludes": { "@id": "AgentRoleCollection/" },
      "schema:rangeIncludes": { "@id": "AgentRole/" }
    },
    {
      "@id": "role/",
      "@type": "owl:ObjectProperty",
      "rdfs:label": "role",
      "rdfs:comment": "The specific role or function the agent performs.",
      "schema:domainIncludes": { "@id": "AgentRole/" },
      "schema:rangeIncludes": { "@id": "RoleType/" }
    },
    {
      "@id": "wasTriggeredBy/",
      "@type": "owl:ObjectProperty",
      "rdfs:label": "was triggered by",
      "rdfs:comment": "Links an automatic activity (like MetaWeave) to the activity that triggered it.",
      "schema:domainIncludes": { "@id": "prov:Activity" },
      "schema:rangeIncludes": { "@id": "prov:Activity" }
    },
    {
      "@id": "ProvenanceContextShape/",
      "@type": "sh:NodeShape",
      "sh:targetClass": { "@id": "ProvenanceContext/" },
      "sh:property": [
        {
          "@type": "sh:PropertyShape",
          "sh:path": { "@id": "forActivity/" },
          "sh:class": { "@id": "prov:Activity" },
          "sh:minCount": 1,
          "sh:maxCount": 1,
          "sh:message": "Provenance context must reference exactly one activity"
        },
        {
          "@type": "sh:PropertyShape",
          "sh:path": { "@id": "forSnapshot/" },
          "sh:class": { "@id": "flow:Snapshot/" },
          "sh:minCount": 1,
          "sh:maxCount": 1,
          "sh:message": "Provenance context must reference exactly one snapshot"
        },
        {
          "@type": "sh:PropertyShape",
          "sh:path": { "@id": "prov:wasAttributedTo" },
          "sh:class": { "@id": "prov:Agent" },
          "sh:minCount": 1,
          "sh:maxCount": 1,
          "sh:message": "Provenance context must have exactly one primary agent"
        }
      ]
    },
    {
      "@id": "DelegationStepShape/",
      "@type": "sh:NodeShape",
      "sh:targetClass": { "@id": "DelegationStep/" },
      "sh:property": [
        {
          "@type": "sh:PropertyShape",
          "sh:path": { "@id": "prov:agent" },
          "sh:class": { "@id": "prov:Agent" },
          "sh:minCount": 1,
          "sh:maxCount": 1,
          "sh:message": "Delegation step must have exactly one agent"
        },
        {
          "@type": "sh:PropertyShape",
          "sh:path": { "@id": "stepOrder/" },
          "sh:datatype": { "@id": "xsd:integer" },
          "sh:minInclusive": 1,
          "sh:message": "Step order must be a positive integer"
        }
      ]
    },
    {
      "@id": "AgentRoleShape/",
      "@type": "sh:NodeShape",
      "sh:targetClass": { "@id": "AgentRole/" },
      "sh:property": [
        {
          "@type": "sh:PropertyShape",
          "sh:path": { "@id": "prov:agent" },
          "sh:class": { "@id": "prov:Agent" },
          "sh:minCount": 1,
          "sh:maxCount": 1,
          "sh:message": "Agent role must have exactly one agent"
        },
        {
          "@type": "sh:PropertyShape",
          "sh:path": { "@id": "role/" },
          "sh:class": { "@id": "RoleType/" },
          "sh:minCount": 1,
          "sh:maxCount": 1,
          "sh:message": "Agent role must specify exactly one role type"
        },
        {
          "@id": "DelegationStepConditionalShape/",
          "@type": "sh:NodeShape",
          "sh:targetClass": { "@id": "DelegationStep/" },
          "sh:or": [
            {
              "@type": "sh:NodeShape",
              "sh:property": [
                {
                  "@type": "sh:PropertyShape",
                  "sh:path": { "@id": "stepOrder/" },
                  "sh:hasValue": 1
                }
              ]
            },
            {
              "@type": "sh:NodeShape",
              "sh:property": [
                {
                  "@type": "sh:PropertyShape",
                  "sh:path": { "@id": "stepOrder/" },
                  "sh:minExclusive": 1
                },
                {
                  "@type": "sh:PropertyShape",
                  "sh:path": { "@id": "prov:actedOnBehalfOf" },
                  "sh:class": { "@id": "prov:Agent" },
                  "sh:minCount": 1,
                  "sh:maxCount": 1,
                  "sh:message": "Delegation steps after step 1 must specify exactly one entity the agent acts for"
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}
