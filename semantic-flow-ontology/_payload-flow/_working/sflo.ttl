@base <https://semantic-flow.github.io/semantic-flow-ontology/> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix dcat: <http://www.w3.org/ns/dcat#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix schema: <https://schema.org/> .
@prefix vann: <http://purl.org/vocab/vann/> .
@prefix prov: <http://www.w3.org/ns/prov#> .

<> a owl:Ontology ;
  dcterms:title "Semantic Flow Ontology" ;
  dcterms:description "The Semantic Flow ontology defines the classes and properties used for defining and describing semantic meshes and their resources." ;
  dcterms:creator <https://djradon.github.io/ns/djradon> ;
  owl:versionInfo "0.0.1" ;
  owl:versionIRI <https://semantic-flow.github.io/semantic-flow-ontology/_knops/_payload/_working/sflo.ttl/sflo.ttl> ;
  vann:preferredNamespacePrefix "sflo" ;
  vann:preferredNamespaceUri <https://semantic-flow.github.io/semantic-flow-ontology/> .

#################################################################
#################################################################
# General-purpose vocabulary
#################################################################
#################################################################

#################################################################
# DigitalArtifact
#################################################################


<DigitalArtifact> a rdfs:Class ;
  rdfs:label "Digital artifact" ;
  rdfs:comment "A file-like digital object (documents, specifications, datasets, pages, binary assets), whether abstract or location-specific. A DigitalArtifact may exist inside or outside any Semantic Flow mesh." .

<ArtifactContainer> a rdfs:Class ;
  rdfs:label "Artifact container" ;
  rdfs:comment "A resource that hosts/contains artifacts and other structural resources. Not itself required to be a DigitalArtifact." .

#################################################################
# Artifact facet lattice
#################################################################

<narrowerFacet> a owl:ObjectProperty, owl:TransitiveProperty ;
  rdfs:domain <DigitalArtifact> ;
  rdfs:range <DigitalArtifact> ;
  rdfs:label "narrower facet" ;
  rdfs:comment "Relates a broader DigitalArtifact to a narrower DigitalArtifact facet within the same artifact structure. Intended to be closed (tree-shaped) within a mesh-managed Flow, but may be used more loosely for external artifacts." .

<broaderFacet> a owl:ObjectProperty ;
  owl:inverseOf <narrowerFacet> ;
  rdfs:domain <DigitalArtifact> ;
  rdfs:range <DigitalArtifact> ;
  rdfs:label "broader facet" ;
  rdfs:comment "Inverse of narrowerFacet." .

#################################################################
# Core artifact model (AbstractArtifact / Flow / State / AbstractFile / LocatedFile)
#################################################################

<AbstractArtifact> a rdfs:Class ;
  rdfs:subClassOf <DigitalArtifact> ;
  rdfs:label "Abstract artifact" ;
  rdfs:comment "The primary, whole-artifact identity. In a Semantic Mesh, each AbstractArtifact has exactly one Flow that supplies its working and historical states." .

<ArtifactFlow> a rdfs:Class ;
  rdfs:subClassOf <DigitalArtifact> ;
  rdfs:label "Flow" ;
  rdfs:comment "The over-time identity for an DigitalArtifact. An ArtifactFlow relates exactly one WorkingState, exactly one CurrentState, and zero or more HistoricalStates." .

<ArtifactState> a rdfs:Class ;
  rdfs:subClassOf <DigitalArtifact> ;
  rdfs:label "State" ;
  rdfs:comment "A single-state content identity within a DigitalArtifact. ArtifactStates may be mutable (working) or immutable (historical)." .

<CurrentState> a rdfs:Class ;
  rdfs:subClassOf <ArtifactState> ;
  rdfs:label "Current state" ;
  rdfs:comment "The mutable-at-weave current state for a DigitalArtifact. By convention in meshes, this is surfaced at a reserved '_current' path segment." .

<WorkingState> a rdfs:Class ;
  rdfs:subClassOf <ArtifactState> ;
  rdfs:label "Working state" ;
  rdfs:comment "The always-mutable working state for a DigitalArtifact. By convention in meshes, this is surfaced at a reserved '_working' path segment." .

<HistoricalState> a rdfs:Class ;
  rdfs:subClassOf <ArtifactState> ;
  rdfs:label "Historical state" ;
  rdfs:comment "An immutable snapshot state for a DigitalArtifact." .

<AbstractFile> a rdfs:Class ;
  rdfs:subClassOf <DigitalArtifact> ;
  rdfs:label "Abstract file" ;
  rdfs:comment "A file-level identity for a particular State: a specific file variant (e.g., TTL vs JSON-LD, zipped vs unzipped, or distinct build/canonicalization choices) whose bytes may be served from one or more LocatedFiles. Multiple AbstractFiles may exist for the same State, including multiple variants within the same media type or extension. In mesh file layouts that reserve direct State children for AbstractFiles, AbstractFile identifiers MUST NOT start with '_' and SHOULD NOT be 'index.html'." .

<LocatedFile> a rdfs:Class ;
  rdfs:subClassOf <DigitalArtifact> ;
  rdfs:label "Located file" ;
  rdfs:comment "A retrievable bytes identity (typically with an extension). A LocatedFile may be used as a facet of broader artifacts (AbstractFile, State, Flow, AbstractArtifact) and may also be treated as an AbstractArtifact in external/collapsed cases." .

#################################################################
# Core structural relations (also participate in narrowerFacet)
#################################################################

<hasFlow> a owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:subPropertyOf <narrowerFacet> ;
  rdfs:domain <AbstractArtifact> ;
  rdfs:range <ArtifactFlow> ;
  rdfs:label "has flow" ;
  rdfs:comment "Relates an AbstractArtifact to its Flow. Mesh convention: exactly one Flow per AbstractArtifact." .

<hasState> a owl:ObjectProperty ;
  rdfs:subPropertyOf <narrowerFacet> ;
  rdfs:domain <ArtifactFlow> ;
  rdfs:range <ArtifactState> ;
  rdfs:label "has state" ;
  rdfs:comment "Relates a Flow to one of its States." .

<hasCurrentState> a owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:subPropertyOf <narrowerFacet>, <hasState> ;
  rdf:type owl:FunctionalProperty ;
  rdfs:domain <ArtifactFlow> ;
  rdfs:range <CurrentState> ;
  rdfs:label "has current state" ;
  rdfs:comment "Relates a Flow to its current (mutable-at-weave) State. Mesh convention: exactly one current state per Flow." .
  
<hasWorkingState> a owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:subPropertyOf <narrowerFacet>, <hasState> ;
  rdfs:domain <ArtifactFlow> ;
  rdfs:range <WorkingState> ;
  rdfs:label "has working state" ;
  rdfs:comment "Relates a Flow to its working (mutable) State. Mesh convention: exactly one working state per Flow." .

<hasHistoricalState> a owl:ObjectProperty ;
  rdfs:subPropertyOf <narrowerFacet>, <hasState> ;
  rdfs:domain <ArtifactFlow> ;
  rdfs:range <HistoricalState> ;
  rdfs:label "has historical state" ;
  rdfs:comment "Relates a Flow to a published historical State." .

<previousHistoricalState> a owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:subPropertyOf prov:wasRevisionOf ;
  rdfs:domain <HistoricalState> ;
  rdfs:range <HistoricalState> ;
  rdfs:label "previous historical state" ;
  rdfs:comment "Links a HistoricalState to the immediately preceding HistoricalState in its published revision lineage." .

<latestHistoricalState> a owl:ObjectProperty ;
  rdfs:subPropertyOf <hasHistoricalState> ;
  rdf:type owl:FunctionalProperty ;
  rdfs:domain <ArtifactFlow> ;
  rdfs:range <HistoricalState> ;
  rdfs:label "latest historical state" ;
  rdfs:comment "Optional convenience pointer from a Flow to its latest (most recently published) HistoricalState. This is a logical pointer in RDF and does not imply any filesystem aliasing." .

<hasAbstractFile> a owl:ObjectProperty ;
  rdfs:subPropertyOf <narrowerFacet> ;
  rdfs:domain <ArtifactState> ;
  rdfs:range <AbstractFile> ;
  rdfs:label "has abstract file" ;
  rdfs:comment "Relates a State to one of its AbstractFile variants." .

<hasLocatedFile> a owl:ObjectProperty ;
  rdfs:subPropertyOf <narrowerFacet> ;
  rdfs:domain <AbstractFile> ;
  rdfs:range <LocatedFile> ;
  owl:inverseOf <locatesAbstractFile> ;
  rdfs:label "has located file" ;
  rdfs:comment "Relates an AbstractFile to one or more LocatedFiles that provide retrievable bytes." .

<locatesAbstractFile> a owl:ObjectProperty ;
  rdfs:domain <LocatedFile> ;
  rdfs:range <AbstractFile> ;
  owl:inverseOf <hasLocatedFile> ;
  rdfs:label "locates abstract file" ;
  rdfs:comment "Navigation: links a LocatedFile to an AbstractFile whose bytes it provides." .

#################################################################
# Optional skip-links (structural narrowing shortcuts)
#################################################################

<locatedFileForState> a owl:ObjectProperty ;
  rdfs:subPropertyOf <narrowerFacet> ;
  rdfs:domain <ArtifactState> ;
  rdfs:range <LocatedFile> ;
  rdfs:label "located file for state" ;
  rdfs:comment "Optional shortcut relating a State directly to a LocatedFile. When present in mesh-managed data, it SHOULD be consistent with the chain: hasAbstractFile / hasLocatedFile." .

#################################################################
# Content kinds
#################################################################

<RdfDocument> a rdfs:Class ;
  rdfs:subClassOf <DigitalArtifact> ;
  rdfs:label "RDF document" ;
  rdfs:comment "A DigitalArtifact whose content is at least one RDF graph. Concrete bytes are an RDF document in an RDF serialization (e.g., Turtle, JSON-LD, TriG, N-Quads). May be used to type an AbstractArtifact, a Flow, specific State(s), an AbstractFile, or a LocatedFile, depending on modeling needs." .

#################################################################
# Web presentation
#################################################################

<ResourcePage> a rdfs:Class ;
  rdfs:subClassOf <LocatedFile>, schema:WebPage ;
  rdfs:label "Resource page file" ;
  rdfs:comment "An HTML page that presents a resource. By convention, resource pages are located at a reserved 'index.html' located-file name. Mesh layout invariant: reserve 'index.html' for ResourcePages; other artifact facets SHOULD NOT use 'index.html' as their identifier token." .

<hasResourcePage> a owl:ObjectProperty ;
  rdfs:domain rdfs:Resource ;
  rdfs:range <ResourcePage> ;
  rdfs:label "has resource page file" ;
  rdfs:comment "Associates any resource with a human-readable presentation page." .

#################################################################
# Reference data
#################################################################

<ReferenceLink> a rdfs:Class ;
  rdfs:label "Reference link" ;
  rdfs:comment "A relator describing a reference-data link from a resource to a specific reference data source, including role metadata." .

<ReferenceRole> a rdfs:Class ;
  rdfs:label "Reference role" ;
  rdfs:comment "A controlled vocabulary of roles describing how a ReferenceLink should be used." .

<ReferenceRole/Canonical> a <ReferenceRole> ;
  rdfs:label "Canonical" .

<ReferenceRole/Supplemental> a <ReferenceRole> ;
  rdfs:label "Supplemental" .

<ReferenceRole/Deprecated> a <ReferenceRole> ;
  rdfs:label "Deprecated" .

<hasReferenceLink> a owl:ObjectProperty ;
  rdfs:domain rdfs:Resource ;
  rdfs:range <ReferenceLink> ;
  owl:inverseOf <referenceLinkFor> ;
  rdfs:label "has reference link"@en ;
  rdfs:comment "Associates a resource with a ReferenceLink that provides external or supporting reference information about it." .

<referenceLinkFor> a owl:ObjectProperty ;
  rdfs:domain <ReferenceLink> ;
  rdfs:range rdfs:Resource ;
  owl:inverseOf <hasReferenceLink> ;
  rdfs:label "reference link for"@en ;
  rdfs:comment "Identifies the resource that a ReferenceLink is about." .

<hasReferenceRole> a owl:ObjectProperty ;
  rdfs:domain <ReferenceLink> ;
  rdfs:range <ReferenceRole> ;
  rdfs:label "has reference role" ;
  rdfs:comment "Assigns one or more ReferenceRoles to this ReferenceLink, indicating how the reference data should be used." .

<referenceTarget> a owl:ObjectProperty ;
  rdfs:domain <ReferenceLink> ;
  rdfs:range rdfs:Resource ;
  rdfs:label "reference target" ;
  rdfs:comment "If present, the reference target is a resource used as a reference-data identifier." .

<referenceUriLiteral> a owl:DatatypeProperty ;
  rdfs:domain <ReferenceLink> ;
  rdfs:range xsd:anyURI ;
  rdfs:label "reference URI literal" ;
  rdfs:comment "If present, a retrievable location for reference data (without asserting denotation). May be used alongside referenceTarget or alone." .

<lastVerifiedAt> a owl:DatatypeProperty ;
  rdfs:domain <ReferenceLink> ;
  rdfs:range xsd:dateTimeStamp ;
  rdfs:label "last verified at" ;
  rdfs:comment "Most recent verification timestamp for this reference link." .

<lastVerifiedBy> a owl:ObjectProperty ;
  rdfs:domain <ReferenceLink> ;
  rdfs:range dcterms:Agent ;
  rdfs:label "last verified by" ;
  rdfs:comment "Agent responsible for the most recent verification of this reference link." .

#################################################################
#################################################################
# Semantic Flow resources
#################################################################
#################################################################

<SemanticFlowResource> a rdfs:Class ;
  rdfs:label "Semantic Flow resource" ;
  rdfs:comment "A resource modeled using Semantic Flow conventions and vocabulary. Semantic Flow resources may exist inside or outside a mesh." .

<containsSemanticFlowResource> a owl:ObjectProperty ;
  rdfs:subPropertyOf dcterms:hasPart ;
  rdfs:domain <ArtifactContainer> ;
  rdfs:range <SemanticFlowResource> ;
  rdfs:label "contains Semantic Flow resource" ;
  rdfs:comment "Structural containment relation for Semantic Flow resources, asserted from an artifact-hosting resource (Mesh, Knop, or Nomen)." .

#################################################################
# Semantic Meshes
#################################################################

<Mesh> a rdfs:Class ;
  rdfs:subClassOf <SemanticFlowResource>, <ArtifactContainer> ;
  rdfs:label "Mesh" ;
  rdfs:comment "A servable filesystem region (conventionally surfaced via a reserved _mesh/ handle) that contains Semantic Flow resources and other supporting resources." .

<meshBase> a owl:DatatypeProperty ;
  rdfs:domain <Mesh> ;
  rdfs:range xsd:anyURI ;
  rdfs:label "mesh base" ;
  rdfs:comment "A mesh's canonical BASE (publish location). Represented as a URI literal to avoid asserting anything about the denoted thing." .

#################################################################
# Naming
#################################################################

<Nomen> a rdfs:Class ;
  rdfs:subClassOf <SemanticFlowResource>, <ArtifactContainer> ;
  rdfs:label "Nomen" ;
  rdfs:comment "A naming-object resource (conventionally located at a reserved _nomen/ path) that records a designatorPath token (interpreted relative to the mesh base) and ties that token to what it is about. A Nomen may specify, via ReferenceLinks, additional sources of reference data about what it is about." .

<containsNomen> a owl:ObjectProperty ;
  rdfs:domain <Mesh> ;
  rdfs:range <Nomen> ;
  rdfs:subPropertyOf <containsSemanticFlowResource> ;
  rdfs:label "contains nomen"@en ;
  rdfs:comment "Asserts that a Nomen participates in (and is inventoried by) a Mesh's naming surface. This supports meshes whose naming vehicle exists independent of any filesystem serialization or dereferenceable publication."@en .

<designatorPath> a owl:DatatypeProperty ;
  rdfs:domain <Nomen> ;
  rdfs:range xsd:string ;
  rdfs:label "designator path" ;
  rdfs:comment "Path token for the Nomen's designator. Interpreted relative to the mesh base. Use no leading slash. The empty string denotes the mesh root Nomen." .

<designates> a owl:ObjectProperty ;
  rdfs:domain <Nomen> ;
  rdfs:range rdfs:Resource ;
  rdfs:label "designates" ;
  rdfs:comment "Optional asserted designatum for the Nomen's designator token. If absent, the Nomen may be anchored only via ReferenceLinks (or used purely for token management)." .

#################################################################
# Knops + payload artifacts
#################################################################

<Knop> a rdfs:Class ;
  rdfs:subClassOf <SemanticFlowResource>, <ArtifactContainer> ;
  rdfs:label "Knop" ;
  rdfs:comment "A container for primary payload artifacts and supporting artifacts." .

<containsKnop> a owl:ObjectProperty ;
  rdfs:domain <Mesh> ;
  rdfs:range <Knop> ;
  rdfs:subPropertyOf <containsSemanticFlowResource> ;
  rdfs:label "contains knop"@en ;
  rdfs:comment "Asserts that a Knop is a member of (and is inventoried by) a Mesh. This is a semantic containment/inventory assertion, not a filesystem directory listing, and can apply to meshes that exist only in memory."@en .

<PayloadArtifact> a rdfs:Class ;
  rdfs:subClassOf <AbstractArtifact>, <SemanticFlowResource> ;
  rdfs:label "Payload artifact" ;
  rdfs:comment "A primary AbstractArtifact hosted by a Knop." .

<containsPayloadArtifact> a owl:ObjectProperty ;
  rdfs:subPropertyOf <containsSemanticFlowResource> ;
  rdfs:domain <Knop> ;
  rdfs:range <PayloadArtifact> ;
  rdfs:label "contains payload artifact" ;
  rdfs:comment "Links a Knop to its primary payload AbstractArtifact." .

<payloadSlug> a owl:DatatypeProperty ;
  rdfs:domain <AbstractArtifact> ;
  rdfs:range xsd:string ;
  rdfs:label "payload slug" ;
  rdfs:comment "Stable, immutable slug used as an AbstractArtifact's identifier path segment in a mesh file layout (folder name). Changing it changes IRIs and should be treated as minting a new AbstractArtifact. Mesh invariant: payloadSlug MUST NOT be 'index.html' and SHOULD NOT start with '_' (reserved for structural items)." .

<preferredPayloadFileSlug> a owl:DatatypeProperty ;
  rdfs:domain <AbstractArtifact> ;
  rdfs:range xsd:string ;
  rdfs:label "preferred payload file slug" ;
  rdfs:comment "Mutable filename-stem preference for LocatedFiles (e.g., 'alice-bio'). Generators may ignore/sanitize it and must resolve collisions mechanically (e.g., suffix or hash). Mesh invariant: should avoid values that would result in a LocatedFile named 'index.html'." .

<preferredPayloadSlug> a owl:DatatypeProperty ;
  owl:deprecated true ;
  rdfs:domain <Knop> ;
  rdfs:range xsd:string ;
  rdfs:label "preferred payload slug" ;
  rdfs:comment "DEPRECATED. Replaced by payloadSlug (immutable identifier segment) and preferredPayloadFileSlug (mutable filename preference)." .

#################################################################
# Metadata payload artifacts
#################################################################

<KnopMetadataArtifact> a rdfs:Class ;
  rdfs:subClassOf <AbstractArtifact>, <RdfDocument>, <SemanticFlowResource> ;
  rdfs:label "Knop metadata artifact" ;
  rdfs:comment "Small, discoverable: structure/pointers/summary inventory for the Knop. Modeled as an AbstractArtifact with a Flow and States." .

<MeshMetadataArtifact> a rdfs:Class ;
  rdfs:subClassOf <AbstractArtifact>, <RdfDocument>, <SemanticFlowResource> ;
  rdfs:label "Mesh metadata artifact" ;
  rdfs:comment "Optional mesh-level operational metadata/config. Modeled as an AbstractArtifact with a Flow and States." .

<NomenMetadataArtifact> a rdfs:Class ;
  rdfs:subClassOf <AbstractArtifact>, <RdfDocument>, <SemanticFlowResource> ;
  rdfs:label "Nomen metadata artifact" ;
  rdfs:comment "Metadata about a Nomen. Modeled as an AbstractArtifact with a Flow and States." .

<containsKnopMetadataArtifact> a owl:ObjectProperty ;
  rdfs:subPropertyOf <containsSemanticFlowResource> ;
  rdfs:domain <Knop> ;
  rdfs:range <KnopMetadataArtifact> ;
  rdfs:label "contains knop metadata artifact" ;
  rdfs:comment "Links a Knop to its knop metadata artifact (if present)." .

<containsMeshMetadataArtifact> a owl:ObjectProperty ;
  rdfs:subPropertyOf <containsSemanticFlowResource> ;
  rdfs:domain <Mesh> ;
  rdfs:range <MeshMetadataArtifact> ;
  rdfs:label "contains mesh metadata artifact" ;
  rdfs:comment "Links a Mesh to its mesh metadata artifact (if present)." .

<containsNomenMetadataArtifact> a owl:ObjectProperty ;
  rdfs:subPropertyOf <containsSemanticFlowResource> ;
  rdfs:domain <Nomen> ;
  rdfs:range <NomenMetadataArtifact> ;
  rdfs:label "contains nomen metadata artifact" ;
  rdfs:comment "Links a Nomen to its nomen metadata artifact (if present)." .

#################################################################
# Inventory artifacts
#################################################################

<MeshInventoryArtifact> a rdfs:Class ;
  rdfs:subClassOf <AbstractArtifact>, <RdfDocument>, <SemanticFlowResource> ;
  rdfs:label "Mesh inventory artifact" ;
  rdfs:comment "Index for explorability at the mesh level." .

<KnopInventoryArtifact> a rdfs:Class ;
  rdfs:subClassOf <AbstractArtifact>, <RdfDocument>, <SemanticFlowResource> ;
  rdfs:label "Knop inventory artifact" ;
  rdfs:comment "Index for explorability at the knop level." .

<NomenInventoryArtifact> a rdfs:Class ;
  rdfs:subClassOf <AbstractArtifact>, <RdfDocument>, <SemanticFlowResource> ;
  rdfs:label "Nomen inventory artifact" ;
  rdfs:comment "Index for explorability at the nomen level." .

<containsMeshInventoryArtifact> a owl:ObjectProperty ;
  rdfs:subPropertyOf <containsSemanticFlowResource> ;
  rdfs:domain <Mesh> ;
  rdfs:range <MeshInventoryArtifact> ;
  rdfs:label "contains mesh inventory artifact" ;
  rdfs:comment "Links a Mesh to zero or more derived MeshInventoryArtifacts (may be large and/or sharded)." .

<containsKnopInventoryArtifact> a owl:ObjectProperty ;
  rdfs:subPropertyOf <containsSemanticFlowResource> ;
  rdfs:domain <Knop> ;
  rdfs:range <KnopInventoryArtifact> ;
  rdfs:label "contains knop inventory artifact" ;
  rdfs:comment "Links a Knop to zero or more derived KnopInventoryArtifacts (may be large and/or sharded)." .

<containsNomenInventoryArtifact> a owl:ObjectProperty ;
  rdfs:subPropertyOf <containsSemanticFlowResource> ;
  rdfs:domain <Nomen> ;
  rdfs:range <NomenInventoryArtifact> ;
  rdfs:label "contains nomen inventory artifact" ;
  rdfs:comment "Links a Nomen to zero or more derived NomenInventoryArtifacts (may be large and/or sharded)." .

